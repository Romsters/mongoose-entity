# mongoose-entity
mongoose-entity is a class-based wrapper for mongoose that supports new javascript syntax.

## Models
Each model should extends MongooseEntity model. MongooseEntity model contains an _id property that will be assigned to passed value or unique identifier generated by default.
```
var mongoose = require('mongoose-entity').mongoose;
var MongooseEntity = require('mongoose-entity').MongooseEntity;

var createdBy = new WeakMap();

class Entity extends MongooseEntity {
  constructor(spec) {
    super(spec);
    this.createdBy = spec.createdBy;
  }
  get createdBy() {
    return createdBy.get(this);
  }
  set createdBy(value) {
    if(!value || typeof value !== 'string') {
      throw 'createdBy prop should be not empty string';
    }
    createdBy.set(this, value);
  }
}
```
Model can extends another model.
```
var name = new WeakMap();
var books = new WeakMap();

class User extends Entity {
  constructor(spec) {
    super(spec);
    this.name = spec.name;
    this.books = spec.books;
  }
  get name() {
    return name.get(this);
  }
  set name(value) {
    if(!value || typeof value !== 'string') {
        throw 'name prop should be not empty string';
    }
    name.set(this, value);
  }
  get books() {
    return books.get(this);
  }
  set books(value) {
    if(!value || !value.length) {
      throw 'books prop should be an array';
    }
    for(let book of value) {
      if(!(book instanceof Book) && !(book instanceof mongoose.Types.ObjectId)) {
        throw 'each book should be an instance of Book or a reference to the book';
      }
    }
    books.set(this, value);
  }
}

var title = new WeakMap();
var author = new WeakMap();

class Book extends Entity {
  constructor(spec) {
    super(spec);
    this.title = spec.title;
    this.author = spec.author;
  }
  get title() {
    return title.get(this);
  }
  set title(value) {
    if(!value || typeof value !== 'string') {
      throw 'title prop should be not empty string';
    }
    title.set(this, value);
  }
  get author() {
    return author.get(this);
  }
  set author(value) {
    if(!(value instanceof User) && !(value instanceof mongoose.Types.ObjectId)) {
      throw 'author should be an instance of User or a reference to the user';
    }
    author.set(this, value);
  }
}
```
